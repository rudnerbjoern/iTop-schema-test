<?xml version="1.0" encoding="UTF-8"?>
<itop_design version="3.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../3.2/itop_design.xsd">
    <!--
    This file serves as a quick reference for the iTop datamodel structure.
    It is intended solely for schema validation and must never produce any errors.
    The content will evolve gradually as new elements are introduced into the schema.
    -->
    <!-- ***************** Classes ***************** -->

    <!-- ***************** Menus ***************** -->
    <menus>
        <menu id="1" xsi:type="MenuGroup">
            <rank>1.2</rank>
            <enable_admin_only>1</enable_admin_only>
            <enable_class>name</enable_class>
            <enable_action>UR_ACTION_MODIFY</enable_action>
            <enable_permission>UR_ALLOWED_YES</enable_permission>
            <enable_stimulus>ev_assign</enable_stimulus>
            <style>
                <decoration_classes>aaa</decoration_classes>
            </style>
        </menu>
        <menu id="2" xsi:type="DashboardMenuNode">
            <enable_action>UR_ACTION_BULK_READ</enable_action>
            <enable_admin_only>1</enable_admin_only>
            <enable_class>class</enable_class>
            <enable_permission>UR_ALLOWED_NO</enable_permission>
            <enable_stimulus>aaa</enable_stimulus>
            <parent>123</parent>
            <rank>22.3</rank>
            <definition>
                <cells>
                    <cell id="1">
                        <rank>10</rank>
                        <dashlets>
                            <dashlet id="badge1" xsi:type="DashletBadge">
                                <rank>10</rank>
                                <class>class1</class>
                            </dashlet>
                        </dashlets>
                    </cell>
                </cells>
            </definition>
            <definition_file>filename</definition_file>
        </menu>
        <menu id="3" xsi:type="NewObjectMenuNode" _delta="define">
            <rank>123.45</rank>
            <enable_admin_only>1</enable_admin_only>
            <parent>parent</parent>
            <class>class1</class>
            <enable_class>class2</enable_class>
            <enable_action>UR_ACTION_BULK_READ</enable_action>
            <enable_permission>UR_ALLOWED_YES</enable_permission>
        </menu>
        <menu id="4" xsi:type="SearchMenuNode">
            <rank>12.3</rank>
            <enable_admin_only>0</enable_admin_only>
            <parent>1</parent>
            <class>class3</class>
            <enable_class>class4</enable_class>
            <enable_action>UR_ACTION_DELETE</enable_action>
        </menu>
        <menu id="5" xsi:type="TemplateMenuNode">
            <rank>1.2</rank>
            <parent>1</parent>
            <template_file>filename</template_file>
            <enable_class>class3</enable_class>
            <enable_action>UR_ACTION_BULK_MODIFY</enable_action>
        </menu>
        <menu id="6" xsi:type="OQLMenuNode">
            <rank>6.2</rank>
            <parent>1</parent>
            <auto_reload>none</auto_reload>
            <oql>SELECT</oql>
            <do_search>1</do_search>
            <search_form_open>1</search_form_open>
            <enable_class>class2</enable_class>
            <enable_admin_only>0</enable_admin_only>
        </menu>
        <menu id="6.3" xsi:type="OQLMenuNode">
            <rank>6.3</rank>
            <parent>1</parent>
            <auto_reload>120</auto_reload>
            <oql>SELECT</oql>
            <do_search>1</do_search>
            <search_form_open>1</search_form_open>
            <enable_class>class2</enable_class>
            <enable_admin_only>1</enable_admin_only>
        </menu>
        <menu id="7" xsi:type="WebPageMenuNode">
            <rank>7</rank>
            <parent>1</parent>
            <url>$$https://www.openitop.com/</url>
            <in_new_window>true</in_new_window>
            <enable_admin_only>1</enable_admin_only>
        </menu>
        <menu id="8" xsi:type="ShortcutContainerMenuNode">
            <parent>1</parent>
            <rank>8</rank>
        </menu>
        <menu id="Typology" xsi:type="DashboardMenuNode" _delta="if_exists">
            <rank>80</rank>
            <parent>Catalogs</parent>
            <definition>
                <layout>DashboardLayoutOneCol</layout>
                <title>Menu:ConfigManagement:Typology</title>
                <cells>
                    <cell id="0" _delta="if_exists">
                        <dashlets>
                            <dashlet id="20" xsi:type="DashletBadge" _delta="define">
                                <rank>20</rank>
                                <class>class1</class>
                            </dashlet>
                            <dashlet id="21" xsi:type="DashletBadge" _delta="define">
                                <rank>21</rank>
                                <class>class2</class>
                            </dashlet>
                        </dashlets>
                    </cell>
                </cells>
            </definition>
        </menu>
    </menus>
    <!-- ***************** User Rights ***************** -->
    <user_rights>
        <groups>
            <group id="1" _delta="define">
                <classes>
                    <class id="TestClass" />
                    <class id="Test2Class" />
                    <class id="RemoveClass" _delta="delete_if_exists" />
                </classes>
            </group>
        </groups>
        <profiles>
            <profile id="123">
                <name>Test Name</name>
                <description>Test Description</description>
                <groups>
                    <group id="122">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="stimulus:ev_done">allow</action>
                        </actions>
                    </group>
                </groups>
            </profile>
            <profile id="124" _delta="delete" />
            <profile id="125">
                <name _delta="define">Test Name 2</name>
                <description _delta="redefine">description</description>
                <groups>
                    <group id="123" _delta="define">
                        <actions>
                            <action id="action:read" _delta="define" />
                            <action id="action:write" _delta="delete" />
                        </actions>
                    </group>
                    <group id="125" _delta="delete" />
                </groups>
            </profile>
        </profiles>
    </user_rights>
    <!-- ***************** Files ***************** -->
    <files>
        <file id="cron_c8b5" xsi:type="File" _delta="define">
            <name>cron.png</name>
            <mime_type>image/png</mime_type>
            <width>37</width>
            <height>37</height>
            <!-- In tag 'data' provide the image encoded in base 64 -->
            <data>base64String...</data>
        </file>
    </files>
    <!-- ***************** Dictionaries ***************** -->
    <dictionaries>
        <dictionary id="EN US" _delta="define">
            <entries>
                <entry id="Class:Server/Attribute:name"><![CDATA[Server Name]]></entry>
                <entry id="entry-2" _delta="delete" />
            </entries>
        </dictionary>
        <dictionary id="DE DE" _delta="define">
            <entries>
                <entry id="Class:Server/Attribute:name"><![CDATA[Server Name]]></entry>
                <entry id="entry-2" _delta="delete" />
            </entries>
        </dictionary>
    </dictionaries>
    <!-- ***************** Branding ***************** -->
    <branding>
        <login_favicon>
            <fileref ref="cron_c8b5" />
        </login_favicon>
        <login_logo>
            <fileref ref="123" />
        </login_logo>
        <main_favicon>
            <fileref ref="123" />
        </main_favicon>
        <main_logo>
            <fileref ref="123" />
        </main_logo>
        <main_logo_compact>
            <fileref ref="123" />
        </main_logo_compact>
        <portal_favicon>
            <fileref ref="123" />
        </portal_favicon>
        <portal_logo>
            <fileref ref="123" />
        </portal_logo>
        <themes>
            <theme id="theme-1">
                <variables>
                    <variable id="1" _delta="define">#C53030</variable>
                    <variable id="2" _delta="define">#F7FAFC</variable>
                </variables>
                <imports>
                    <import id="css-variables">css-variables</import>
                </imports>
                <stylesheets>
                    <stylesheet id="1">compat.scss</stylesheet>
                    <stylesheet id="2">compat.scss</stylesheet>
                    <stylesheet id="3">main.scss</stylesheet>
                </stylesheets>
            </theme>
            <theme id="test-red" _delta="must_exist">
                <variables _delta="redefine">
                    <variable id="backoffice-environment-banner-background-color" _delta="define">#C53030</variable>
                    <variable id="backoffice-environment-banner-text-color" _delta="define">#F7FAFC</variable>
                    <variable id="backoffice-environment-banner-text-content" _delta="define">"THIS IS A TEST INSTANCE"</variable>
                </variables>
                <imports _delta="redefine">
                    <import id="css-variables" _delta="define">itop-themes-compat/assets/css/css-variables.scss</import>
                </imports>
                <stylesheets _delta="redefine">
                    <stylesheet id="jqueryui" _delta="define">compat.scss</stylesheet>
                    <stylesheet id="main" _delta="define">compat.scss</stylesheet>
                </stylesheets>
            </theme>
        </themes>
        <themes_common>
            <variables>
                <variable id="color-1" _delta="define">#fff</variable>
                <variable id="color-2" _delta="delete_if_exists">#000</variable>
            </variables>
            <imports>
                <import id="1" _delta="merge">111</import>
                <import id="2">222</import>
                <import id="111" _delta="define">filename</import>
            </imports>
            <stylesheets>
                <stylesheet id="123">test</stylesheet>
            </stylesheets>
        </themes_common>
    </branding>
    <!-- ***************** Constants ***************** -->
    <constants />
    <!-- ***************** Portals ***************** -->
    <portals>
        <portal id="itop-portal" _delta="define">
            <!-- ID must match module_design[id] -->
            <url>url</url>
            <!-- portal_id must match module_design[id] -->
            <rank>1.0</rank>
            <handler />
            <allow />
            <deny />
        </portal>
    </portals>
    <!-- ***************** Module Parameters ***************** -->
    <module_parameters>
        <parameters id="itop-object-copier" _delta="define">
            <rules>
                <rule id="0" type="hash">
                    <source_scope>SELECT UserRequest WHERE status IN ("assigned", "pending")</source_scope>
                    <allowed_profiles>Administrator,Support Agent</allowed_profiles>
                    <menu_label>Issue a change ticket...</menu_label>
                    <form_label>Issue a change from request %1$s. Please review the description before create the change ticket. After creation of the change ticket, the request ticket will be automatically updated. </form_label>
                    <report_label>Issued from the request %1$s. The request has been updated.</report_label>
                    <dest_class>Change</dest_class>
                    <preset type="array">
                        <action id="0"> clone(...)</action>
                        <action id="1">set(...)</action>
                    </preset>
                    <retrofit type="array">
                        <action id="0">copy(id, parent_change_id)'</action>
                        <action id="1">set(private_log,Issued change $this->ref$)'</action>
                    </retrofit>
                </rule>
            </rules>
        </parameters>
        <parameters id="itop-portal" _delta="define">
            <lazy_loading_threshold>500</lazy_loading_threshold>
        </parameters>
    </module_parameters>
    <!-- ***************** Module Designs ***************** -->
    <module_designs />
    <!-- ***************** Snippets ***************** -->
    <snippets>
        <snippet id="snippet-1">
            <placement>module</placement>
            <module>module</module>
            <rank>10</rank>
            <content>content</content>
        </snippet>
        <snippet id="snippet-2">
            <placement>core</placement>
            <rank>20</rank>
            <content>content</content>
        </snippet>
    </snippets>
    <!-- ***************** Meta ***************** -->
    <meta />
    <!-- ***************** Events ***************** -->
    <events>
        <event id="event-1" _delta="define">
            <description>description</description>
            <sources>
                <source id="source-1">cmdbAbstractObject</source>
                <source id="source-2">source2</source>
            </sources>
            <replaces>DBObject::OnInsert</replaces>
            <event_data>
                <event_datum id="event-datum-1">
                    <description>description</description>
                    <type>array</type>
                </event_datum>
                <event_datum id="event-datum-2">
                    <description>description</description>
                    <type>array</type>
                </event_datum>
            </event_data>
        </event>
        <event id="EVENT_DOWNLOAD_DOCUMENT" _delta="define">
            <description>A document has been downloaded from the GUI</description>
            <sources>
                <source id="Document">Document</source>
            </sources>
            <event_data>
                <event_datum id="object">
                    <description>The object containing the document</description>
                    <type>DBObject</type>
                </event_datum>
                <event_datum id="document">
                    <description>The document downloaded</description>
                    <type>ormDocument</type>
                </event_datum>
                <event_datum id="att_code">
                    <description>Attribute code of the object, containing the document</description>
                    <type>string</type>
                </event_datum>
                <event_datum id="content_disposition">
                    <description>To differentiate if the document was displayed in preview or truly downloaded</description>
                    <type>string</type>
                </event_datum>
                <event_datum id="debug_info">
                    <description>Debug string</description>
                    <type>string</type>
                </event_datum>
            </event_data>
        </event>
        <event id="EVENT_DISPLAY_OBJECT_DETAILS" _delta="define">
            <name>Portal object displayed</name>
            <description><![CDATA[An object details is about to be displayed to a user on a portal]]></description>
            <sources>
                <source id="cmdbAbstractObject">cmdbAbstractObject</source>
            </sources>
            <arguments>
                <argument id="object">
                    <description>The object displayed</description>
                    <type>DBObject</type>
                </argument>
                <argument id="debug_info">
                    <description>Debug string</description>
                    <type>string</type>
                </argument>
            </arguments>
        </event>
    </events>
    <!-- ***************** Event Listeners ***************** -->
    <event_listeners>
        <event_listener id="listener-1" _delta="define">
            <event>EVENT_DISPLAY_OBJECT_DETAILS</event>
            <filters>
                <filter>FAQ</filter>
            </filters>
            <rank>10</rank>
            <code>function(\Combodo\iTop\Service\EventData $oEventData) {}</code>
        </event_listener>
        <event_listener id="listener-2" _delta="if_exists">
            <event>EVENT_DB_COMPUTE_VALUES</event>
            <filters>
                <filter _delta="define">FAQ</filter>
            </filters>
            <rank>20</rank>
            <code>function(\Combodo\iTop\Service\EventData $oEventData) {}</code>
        </event_listener>
        <event_listener id="OnAttachmentDownloadActivateTriggers" _delta="define">
            <event>EVENT_DOWNLOAD_DOCUMENT</event>
            <filters>
                <filter>Attachment</filter>
            </filters>
            <rank>0</rank>
            <code><![CDATA[function(Combodo\iTop\Service\Events\EventData $oEventData){ ... }]]></code>
        </event_listener>
    </event_listeners>
</itop_design>
